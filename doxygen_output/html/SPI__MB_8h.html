<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: include/SPI_MB.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">SPI_MB.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>API-definition for the SPI Module in the BMS-System.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;zephyr/drivers/spi.h&gt;</code><br />
<code>#include &lt;zephyr/drivers/gpio.h&gt;</code><br />
<code>#include &lt;zephyr/logging/log.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for SPI_MB.h:</div>
<div class="dyncontent">
<div class="center"><img src="SPI__MB_8h__incl.png" border="0" usemap="#ainclude_2SPI__MB_8h" alt=""/></div>
<map name="ainclude_2SPI__MB_8h" id="ainclude_2SPI__MB_8h">
<area shape="rect" title="API&#45;definition for the SPI Module in the BMS&#45;System." alt="" coords="193,5,326,31"/>
<area shape="rect" title=" " alt="" coords="5,79,156,104"/>
<area shape="poly" title=" " alt="" coords="232,33,123,76,121,71,230,28"/>
<area shape="rect" title=" " alt="" coords="180,79,339,104"/>
<area shape="poly" title=" " alt="" coords="262,31,262,65,257,65,257,31"/>
<area shape="rect" title=" " alt="" coords="363,79,518,104"/>
<area shape="poly" title=" " alt="" coords="289,28,399,71,397,76,287,33"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="SPI__MB_8h__dep__incl.png" border="0" usemap="#ainclude_2SPI__MB_8hdep" alt=""/></div>
<map name="ainclude_2SPI__MB_8hdep" id="ainclude_2SPI__MB_8hdep">
<area shape="rect" title="API&#45;definition for the SPI Module in the BMS&#45;System." alt="" coords="211,5,344,31"/>
<area shape="rect" href="Battery_8h.html" title="API&#45;definition for the battery&#45;module in the BMS&#45;System." alt="" coords="212,79,343,104"/>
<area shape="poly" title=" " alt="" coords="280,44,280,79,275,79,275,44"/>
<area shape="rect" href="CAN__Bus_8h.html" title="API&#45;definition for the Can module in the BMS&#45;System." alt="" coords="12,152,156,177"/>
<area shape="poly" title=" " alt="" coords="227,111,110,154,108,149,226,106"/>
<area shape="rect" href="shutdown__circuit_8h.html" title="API&#45;definition for the shutdown&#45;circuit&#45;module in the BMS&#45;System." alt="" coords="180,152,375,177"/>
<area shape="poly" title=" " alt="" coords="271,118,273,152,268,152,266,118"/>
<area shape="rect" href="Battery_8c.html" title="Implementation of the Battery Management module for the BMS system." alt="" coords="399,152,585,177"/>
<area shape="poly" title=" " alt="" coords="326,106,458,149,456,154,324,111"/>
<area shape="poly" title=" " alt="" coords="134,145,252,102,254,107,136,150"/>
<area shape="rect" href="CAN__Bus_8c.html" title="CAN Bus communication module for Zephyr RTOS." alt="" coords="5,225,163,265"/>
<area shape="poly" title=" " alt="" coords="87,191,87,225,81,225,81,191"/>
<area shape="poly" title=" " alt="" coords="283,139,282,104,287,104,289,138"/>
</map>
</div>
</div>
<p><a href="SPI__MB_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0f38cada613ae1a9c0918543abae1dfe" id="r_a0f38cada613ae1a9c0918543abae1dfe"><td class="memItemLeft" align="right" valign="top"><a id="a0f38cada613ae1a9c0918543abae1dfe" name="a0f38cada613ae1a9c0918543abae1dfe"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>WRCFGA</b>&#160;&#160;&#160;0x0001</td></tr>
<tr class="separator:a0f38cada613ae1a9c0918543abae1dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6d148258b5969469cfe504001bee121" id="r_ab6d148258b5969469cfe504001bee121"><td class="memItemLeft" align="right" valign="top"><a id="ab6d148258b5969469cfe504001bee121" name="ab6d148258b5969469cfe504001bee121"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>WRCFGB</b>&#160;&#160;&#160;0x0024</td></tr>
<tr class="separator:ab6d148258b5969469cfe504001bee121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1c146dd530af54af74d60a52103581" id="r_a1b1c146dd530af54af74d60a52103581"><td class="memItemLeft" align="right" valign="top"><a id="a1b1c146dd530af54af74d60a52103581" name="a1b1c146dd530af54af74d60a52103581"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCFGA</b>&#160;&#160;&#160;0x0002</td></tr>
<tr class="separator:a1b1c146dd530af54af74d60a52103581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f5362f21bdd040a1238a604e55c73a" id="r_a22f5362f21bdd040a1238a604e55c73a"><td class="memItemLeft" align="right" valign="top"><a id="a22f5362f21bdd040a1238a604e55c73a" name="a22f5362f21bdd040a1238a604e55c73a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCFGB</b>&#160;&#160;&#160;0x0026</td></tr>
<tr class="separator:a22f5362f21bdd040a1238a604e55c73a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63290b7e53568396938d263c386c511b" id="r_a63290b7e53568396938d263c386c511b"><td class="memItemLeft" align="right" valign="top"><a id="a63290b7e53568396938d263c386c511b" name="a63290b7e53568396938d263c386c511b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCVA</b>&#160;&#160;&#160;0x0004</td></tr>
<tr class="separator:a63290b7e53568396938d263c386c511b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997ab07d6f83bbc177c69e5027ce4bb1" id="r_a997ab07d6f83bbc177c69e5027ce4bb1"><td class="memItemLeft" align="right" valign="top"><a id="a997ab07d6f83bbc177c69e5027ce4bb1" name="a997ab07d6f83bbc177c69e5027ce4bb1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCVB</b>&#160;&#160;&#160;0x0006</td></tr>
<tr class="separator:a997ab07d6f83bbc177c69e5027ce4bb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a111a141ddded48b962e01eeb841955f1" id="r_a111a141ddded48b962e01eeb841955f1"><td class="memItemLeft" align="right" valign="top"><a id="a111a141ddded48b962e01eeb841955f1" name="a111a141ddded48b962e01eeb841955f1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCVC</b>&#160;&#160;&#160;0x0008</td></tr>
<tr class="separator:a111a141ddded48b962e01eeb841955f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5e27b4ca6ec9de3dcd5855d6c4486c" id="r_a7b5e27b4ca6ec9de3dcd5855d6c4486c"><td class="memItemLeft" align="right" valign="top"><a id="a7b5e27b4ca6ec9de3dcd5855d6c4486c" name="a7b5e27b4ca6ec9de3dcd5855d6c4486c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCVD</b>&#160;&#160;&#160;0x000A</td></tr>
<tr class="separator:a7b5e27b4ca6ec9de3dcd5855d6c4486c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02656ad98f432b30aff8d0c193110ab6" id="r_a02656ad98f432b30aff8d0c193110ab6"><td class="memItemLeft" align="right" valign="top"><a id="a02656ad98f432b30aff8d0c193110ab6" name="a02656ad98f432b30aff8d0c193110ab6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCVE</b>&#160;&#160;&#160;0x0009</td></tr>
<tr class="separator:a02656ad98f432b30aff8d0c193110ab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1549d136d0341e291539c0ec9cb97f3" id="r_ac1549d136d0341e291539c0ec9cb97f3"><td class="memItemLeft" align="right" valign="top"><a id="ac1549d136d0341e291539c0ec9cb97f3" name="ac1549d136d0341e291539c0ec9cb97f3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCVF</b>&#160;&#160;&#160;0x000B</td></tr>
<tr class="separator:ac1549d136d0341e291539c0ec9cb97f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c535610823c8ccc42193ee822860fc" id="r_af2c535610823c8ccc42193ee822860fc"><td class="memItemLeft" align="right" valign="top"><a id="af2c535610823c8ccc42193ee822860fc" name="af2c535610823c8ccc42193ee822860fc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDAUXA</b>&#160;&#160;&#160;0x000C</td></tr>
<tr class="separator:af2c535610823c8ccc42193ee822860fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8171b21f78bdbe9c92e4a55e58bee743" id="r_a8171b21f78bdbe9c92e4a55e58bee743"><td class="memItemLeft" align="right" valign="top"><a id="a8171b21f78bdbe9c92e4a55e58bee743" name="a8171b21f78bdbe9c92e4a55e58bee743"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDAUXB</b>&#160;&#160;&#160;0x000E</td></tr>
<tr class="separator:a8171b21f78bdbe9c92e4a55e58bee743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0045ef707abde96e49202322e563c69" id="r_ac0045ef707abde96e49202322e563c69"><td class="memItemLeft" align="right" valign="top"><a id="ac0045ef707abde96e49202322e563c69" name="ac0045ef707abde96e49202322e563c69"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDAUXC</b>&#160;&#160;&#160;0x000D</td></tr>
<tr class="separator:ac0045ef707abde96e49202322e563c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40105dc480a11f462a9efaa9f96bc2b7" id="r_a40105dc480a11f462a9efaa9f96bc2b7"><td class="memItemLeft" align="right" valign="top"><a id="a40105dc480a11f462a9efaa9f96bc2b7" name="a40105dc480a11f462a9efaa9f96bc2b7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDAUXD</b>&#160;&#160;&#160;0x000F</td></tr>
<tr class="separator:a40105dc480a11f462a9efaa9f96bc2b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4de550d5bdae9cfe7733164ee70a5e0" id="r_ac4de550d5bdae9cfe7733164ee70a5e0"><td class="memItemLeft" align="right" valign="top"><a id="ac4de550d5bdae9cfe7733164ee70a5e0" name="ac4de550d5bdae9cfe7733164ee70a5e0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDSTATA</b>&#160;&#160;&#160;0x0010</td></tr>
<tr class="separator:ac4de550d5bdae9cfe7733164ee70a5e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c2598b2b6b646455599c1a0774a94bb" id="r_a6c2598b2b6b646455599c1a0774a94bb"><td class="memItemLeft" align="right" valign="top"><a id="a6c2598b2b6b646455599c1a0774a94bb" name="a6c2598b2b6b646455599c1a0774a94bb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDSTATB</b>&#160;&#160;&#160;0x0012</td></tr>
<tr class="separator:a6c2598b2b6b646455599c1a0774a94bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1ba8fd1c677bcb8ce2d1bd73ef01785" id="r_af1ba8fd1c677bcb8ce2d1bd73ef01785"><td class="memItemLeft" align="right" valign="top"><a id="af1ba8fd1c677bcb8ce2d1bd73ef01785" name="af1ba8fd1c677bcb8ce2d1bd73ef01785"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>WRSCTRL</b>&#160;&#160;&#160;0x0014</td></tr>
<tr class="separator:af1ba8fd1c677bcb8ce2d1bd73ef01785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabeefbce7b4b3c1cf42be280416d5537" id="r_aabeefbce7b4b3c1cf42be280416d5537"><td class="memItemLeft" align="right" valign="top"><a id="aabeefbce7b4b3c1cf42be280416d5537" name="aabeefbce7b4b3c1cf42be280416d5537"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>WRPWM</b>&#160;&#160;&#160;0x0020</td></tr>
<tr class="separator:aabeefbce7b4b3c1cf42be280416d5537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7f2ff914896e4939e1d7ebea177c2df" id="r_aa7f2ff914896e4939e1d7ebea177c2df"><td class="memItemLeft" align="right" valign="top"><a id="aa7f2ff914896e4939e1d7ebea177c2df" name="aa7f2ff914896e4939e1d7ebea177c2df"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>WRPSB</b>&#160;&#160;&#160;0x001C</td></tr>
<tr class="separator:aa7f2ff914896e4939e1d7ebea177c2df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09c0dbf0d1d3f0a1e69a940017a45932" id="r_a09c0dbf0d1d3f0a1e69a940017a45932"><td class="memItemLeft" align="right" valign="top"><a id="a09c0dbf0d1d3f0a1e69a940017a45932" name="a09c0dbf0d1d3f0a1e69a940017a45932"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDSCTRL</b>&#160;&#160;&#160;0x0016</td></tr>
<tr class="separator:a09c0dbf0d1d3f0a1e69a940017a45932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad5872f78e0c1e0bdb820d5291958c83" id="r_aad5872f78e0c1e0bdb820d5291958c83"><td class="memItemLeft" align="right" valign="top"><a id="aad5872f78e0c1e0bdb820d5291958c83" name="aad5872f78e0c1e0bdb820d5291958c83"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDPWM</b>&#160;&#160;&#160;0x0022</td></tr>
<tr class="separator:aad5872f78e0c1e0bdb820d5291958c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34425f484673a85cc0ac5a3c3277a999" id="r_a34425f484673a85cc0ac5a3c3277a999"><td class="memItemLeft" align="right" valign="top"><a id="a34425f484673a85cc0ac5a3c3277a999" name="a34425f484673a85cc0ac5a3c3277a999"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDPSB</b>&#160;&#160;&#160;0x001E</td></tr>
<tr class="separator:a34425f484673a85cc0ac5a3c3277a999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f872cf00678b2f23f6cbe54da6e80d" id="r_ac1f872cf00678b2f23f6cbe54da6e80d"><td class="memItemLeft" align="right" valign="top"><a id="ac1f872cf00678b2f23f6cbe54da6e80d" name="ac1f872cf00678b2f23f6cbe54da6e80d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>STSCTRL</b>&#160;&#160;&#160;0x0019</td></tr>
<tr class="separator:ac1f872cf00678b2f23f6cbe54da6e80d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b4b155c7656f25b8e97e0a3ee6149e" id="r_ac4b4b155c7656f25b8e97e0a3ee6149e"><td class="memItemLeft" align="right" valign="top"><a id="ac4b4b155c7656f25b8e97e0a3ee6149e" name="ac4b4b155c7656f25b8e97e0a3ee6149e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CLRSCTRL</b>&#160;&#160;&#160;0x0018</td></tr>
<tr class="separator:ac4b4b155c7656f25b8e97e0a3ee6149e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58cfb8c9f31480d0ac0bb5eebfedca7f" id="r_a58cfb8c9f31480d0ac0bb5eebfedca7f"><td class="memItemLeft" align="right" valign="top"><a id="a58cfb8c9f31480d0ac0bb5eebfedca7f" name="a58cfb8c9f31480d0ac0bb5eebfedca7f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CLRCELL</b>&#160;&#160;&#160;0x0711</td></tr>
<tr class="separator:a58cfb8c9f31480d0ac0bb5eebfedca7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69b88484d6a7c40a05ce419eebffbcb7" id="r_a69b88484d6a7c40a05ce419eebffbcb7"><td class="memItemLeft" align="right" valign="top"><a id="a69b88484d6a7c40a05ce419eebffbcb7" name="a69b88484d6a7c40a05ce419eebffbcb7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CLRAUX</b>&#160;&#160;&#160;0x0712</td></tr>
<tr class="separator:a69b88484d6a7c40a05ce419eebffbcb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55cb0f0beb1af1c5a0cc62f66f2b7f13" id="r_a55cb0f0beb1af1c5a0cc62f66f2b7f13"><td class="memItemLeft" align="right" valign="top"><a id="a55cb0f0beb1af1c5a0cc62f66f2b7f13" name="a55cb0f0beb1af1c5a0cc62f66f2b7f13"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CLRSTAT</b>&#160;&#160;&#160;0x0713</td></tr>
<tr class="separator:a55cb0f0beb1af1c5a0cc62f66f2b7f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71597f4411cbe68922444f73f4fef642" id="r_a71597f4411cbe68922444f73f4fef642"><td class="memItemLeft" align="right" valign="top"><a id="a71597f4411cbe68922444f73f4fef642" name="a71597f4411cbe68922444f73f4fef642"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PLADC</b>&#160;&#160;&#160;0x0714</td></tr>
<tr class="separator:a71597f4411cbe68922444f73f4fef642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8221c4ff2efa58d78d55ead3f4dc6071" id="r_a8221c4ff2efa58d78d55ead3f4dc6071"><td class="memItemLeft" align="right" valign="top"><a id="a8221c4ff2efa58d78d55ead3f4dc6071" name="a8221c4ff2efa58d78d55ead3f4dc6071"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DIAGN</b>&#160;&#160;&#160;0x0715</td></tr>
<tr class="separator:a8221c4ff2efa58d78d55ead3f4dc6071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725b9d2986b81351736e77afe3e4a8bf" id="r_a725b9d2986b81351736e77afe3e4a8bf"><td class="memItemLeft" align="right" valign="top"><a id="a725b9d2986b81351736e77afe3e4a8bf" name="a725b9d2986b81351736e77afe3e4a8bf"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>WRCOMM</b>&#160;&#160;&#160;0x0721</td></tr>
<tr class="separator:a725b9d2986b81351736e77afe3e4a8bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dfef66de85f30ce60c4f601d40f6233" id="r_a2dfef66de85f30ce60c4f601d40f6233"><td class="memItemLeft" align="right" valign="top"><a id="a2dfef66de85f30ce60c4f601d40f6233" name="a2dfef66de85f30ce60c4f601d40f6233"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RDCOMM</b>&#160;&#160;&#160;0x0722</td></tr>
<tr class="separator:a2dfef66de85f30ce60c4f601d40f6233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4706c69457a3220867336e51acc2a859" id="r_a4706c69457a3220867336e51acc2a859"><td class="memItemLeft" align="right" valign="top"><a id="a4706c69457a3220867336e51acc2a859" name="a4706c69457a3220867336e51acc2a859"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>STCOMM</b>&#160;&#160;&#160;0x0723</td></tr>
<tr class="separator:a4706c69457a3220867336e51acc2a859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f61941701e0251593e01aec567e6ceb" id="r_a1f61941701e0251593e01aec567e6ceb"><td class="memItemLeft" align="right" valign="top"><a id="a1f61941701e0251593e01aec567e6ceb" name="a1f61941701e0251593e01aec567e6ceb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MUTE</b>&#160;&#160;&#160;0x0028</td></tr>
<tr class="separator:a1f61941701e0251593e01aec567e6ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d80be1c3931b7d0fa1ecbbb9dcf552e" id="r_a7d80be1c3931b7d0fa1ecbbb9dcf552e"><td class="memItemLeft" align="right" valign="top"><a id="a7d80be1c3931b7d0fa1ecbbb9dcf552e" name="a7d80be1c3931b7d0fa1ecbbb9dcf552e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>UNMUTE</b>&#160;&#160;&#160;0x0029</td></tr>
<tr class="separator:a7d80be1c3931b7d0fa1ecbbb9dcf552e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae44092f8f622ec597f8165930718846c" id="r_ae44092f8f622ec597f8165930718846c"><td class="memItemLeft" align="right" valign="top"><a id="ae44092f8f622ec597f8165930718846c" name="ae44092f8f622ec597f8165930718846c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ADCV</b>&#160;&#160;&#160;0x0360</td></tr>
<tr class="separator:ae44092f8f622ec597f8165930718846c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adec67980fc08eec423a9df78f13a496f" id="r_adec67980fc08eec423a9df78f13a496f"><td class="memItemLeft" align="right" valign="top"><a id="adec67980fc08eec423a9df78f13a496f" name="adec67980fc08eec423a9df78f13a496f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ADAX</b>&#160;&#160;&#160;0x04E0</td></tr>
<tr class="separator:adec67980fc08eec423a9df78f13a496f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3d7ea1687d9dd9efa6d8a0cf29ee035" id="r_ae3d7ea1687d9dd9efa6d8a0cf29ee035"><td class="memItemLeft" align="right" valign="top"><a id="ae3d7ea1687d9dd9efa6d8a0cf29ee035" name="ae3d7ea1687d9dd9efa6d8a0cf29ee035"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ADSTAT</b>&#160;&#160;&#160;0x04EA</td></tr>
<tr class="separator:ae3d7ea1687d9dd9efa6d8a0cf29ee035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a600c9da9c9513cf4612350a2fb733b72" id="r_a600c9da9c9513cf4612350a2fb733b72"><td class="memItemLeft" align="right" valign="top"><a id="a600c9da9c9513cf4612350a2fb733b72" name="a600c9da9c9513cf4612350a2fb733b72"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_OF_CLIENTS</b>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a600c9da9c9513cf4612350a2fb733b72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35beee7b0f2f3e294c4a4a69a5f02df4" id="r_a35beee7b0f2f3e294c4a4a69a5f02df4"><td class="memItemLeft" align="right" valign="top"><a id="a35beee7b0f2f3e294c4a4a69a5f02df4" name="a35beee7b0f2f3e294c4a4a69a5f02df4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DUMMY</b>&#160;&#160;&#160;0xAA</td></tr>
<tr class="separator:a35beee7b0f2f3e294c4a4a69a5f02df4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6254a4e77c7f2f980d5f49538893d0ab" id="r_a6254a4e77c7f2f980d5f49538893d0ab"><td class="memItemLeft" align="right" valign="top"><a id="a6254a4e77c7f2f980d5f49538893d0ab" name="a6254a4e77c7f2f980d5f49538893d0ab"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SPI_FREQ</b>&#160;&#160;&#160;1000000</td></tr>
<tr class="separator:a6254a4e77c7f2f980d5f49538893d0ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3fe8993c50b10f70075ac9813f5a2a" id="r_a7b3fe8993c50b10f70075ac9813f5a2a"><td class="memItemLeft" align="right" valign="top"><a id="a7b3fe8993c50b10f70075ac9813f5a2a" name="a7b3fe8993c50b10f70075ac9813f5a2a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SPI_DEVICE</b>&#160;&#160;&#160;DT_NODELABEL(spi1)</td></tr>
<tr class="separator:a7b3fe8993c50b10f70075ac9813f5a2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7e0a7793a9e5ac7288743e6e5ce4b0a6" id="r_a7e0a7793a9e5ac7288743e6e5ce4b0a6"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SPI__MB_8h.html#a7e0a7793a9e5ac7288743e6e5ce4b0a6">spi_generate_pec</a> (const uint8_t data[], size_t len)</td></tr>
<tr class="memdesc:a7e0a7793a9e5ac7288743e6e5ce4b0a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a 15-bit Packet Error Code (PEC) for a data buffer.  <br /></td></tr>
<tr class="separator:a7e0a7793a9e5ac7288743e6e5ce4b0a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a102d72deeb3ff6c0c9f4a9909e737b49" id="r_a102d72deeb3ff6c0c9f4a9909e737b49"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SPI__MB_8h.html#a102d72deeb3ff6c0c9f4a9909e737b49">spi_read_voltages</a> (uint16_t *data_buffer)</td></tr>
<tr class="memdesc:a102d72deeb3ff6c0c9f4a9909e737b49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads voltage measurements from multiple clients.  <br /></td></tr>
<tr class="separator:a102d72deeb3ff6c0c9f4a9909e737b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d0d93aad30a1cc1056de698bfb6eae" id="r_ae4d0d93aad30a1cc1056de698bfb6eae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SPI__MB_8h.html#ae4d0d93aad30a1cc1056de698bfb6eae">spi_read_temp</a> (uint16_t *data_buffer)</td></tr>
<tr class="memdesc:ae4d0d93aad30a1cc1056de698bfb6eae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads auxiliary temperature registers via SPI.  <br /></td></tr>
<tr class="separator:ae4d0d93aad30a1cc1056de698bfb6eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a756ec752a2f31def349d63920a309b52" id="r_a756ec752a2f31def349d63920a309b52"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SPI__MB_8h.html#a756ec752a2f31def349d63920a309b52">spi_read_adbms_temp</a> ()</td></tr>
<tr class="memdesc:a756ec752a2f31def349d63920a309b52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and returns the maximum temperature from ADBMS status registers.  <br /></td></tr>
<tr class="separator:a756ec752a2f31def349d63920a309b52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2451e5eba282f92947029ee03594821" id="r_af2451e5eba282f92947029ee03594821"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SPI__MB_8h.html#af2451e5eba282f92947029ee03594821">spi_set_discharge_cell_x</a> (uint32_t *data_buffer)</td></tr>
<tr class="memdesc:af2451e5eba282f92947029ee03594821"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures cell discharge (balancing) settings via SPI.  <br /></td></tr>
<tr class="separator:af2451e5eba282f92947029ee03594821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fff0df9106ebd6d221e241a90817f8b" id="r_a2fff0df9106ebd6d221e241a90817f8b"><td class="memItemLeft" align="right" valign="top"><a id="a2fff0df9106ebd6d221e241a90817f8b" name="a2fff0df9106ebd6d221e241a90817f8b"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>generatePEC</b> (uint8_t data[], size_t len)</td></tr>
<tr class="separator:a2fff0df9106ebd6d221e241a90817f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa4c99a329e2b7ec6d07e1952ca6c633" id="r_aaa4c99a329e2b7ec6d07e1952ca6c633"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SPI__MB_8h.html#aaa4c99a329e2b7ec6d07e1952ca6c633">spi_wake_up</a> ()</td></tr>
<tr class="memdesc:aaa4c99a329e2b7ec6d07e1952ca6c633"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wakes up the ADBMS1818 daisy chain.  <br /></td></tr>
<tr class="separator:aaa4c99a329e2b7ec6d07e1952ca6c633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59aa2c597ccc26fa3196609668590f67" id="r_a59aa2c597ccc26fa3196609668590f67"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SPI__MB_8h.html#a59aa2c597ccc26fa3196609668590f67">spi_adbms1818_hw_init</a> ()</td></tr>
<tr class="memdesc:a59aa2c597ccc26fa3196609668590f67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the ADBMS hardware.  <br /></td></tr>
<tr class="separator:a59aa2c597ccc26fa3196609668590f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dafc139a3e9ecaf7be453e03ea75465" id="r_a5dafc139a3e9ecaf7be453e03ea75465"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SPI__MB_8h.html#a5dafc139a3e9ecaf7be453e03ea75465">spi_loopback</a> ()</td></tr>
<tr class="memdesc:a5dafc139a3e9ecaf7be453e03ea75465"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a wake-up sequence to the ADBMS1818 using the Daisy Chain method.  <br /></td></tr>
<tr class="separator:a5dafc139a3e9ecaf7be453e03ea75465"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a493e3070f030e5730412abb2bb5b0cb2" id="r_a493e3070f030e5730412abb2bb5b0cb2"><td class="memItemLeft" align="right" valign="top"><a id="a493e3070f030e5730412abb2bb5b0cb2" name="a493e3070f030e5730412abb2bb5b0cb2"></a>
const struct device *&#160;</td><td class="memItemRight" valign="bottom"><b>spi1_dev</b></td></tr>
<tr class="separator:a493e3070f030e5730412abb2bb5b0cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>API-definition for the SPI Module in the BMS-System. </p>
<dl class="section author"><dt>Author</dt><dd>renolluc / grossfa2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>20.04.2025 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a59aa2c597ccc26fa3196609668590f67" name="a59aa2c597ccc26fa3196609668590f67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59aa2c597ccc26fa3196609668590f67">&#9670;&#160;</a></span>spi_adbms1818_hw_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spi_adbms1818_hw_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the ADBMS hardware. </p>
<p>This function initializes the ADBMS hardware by sending configuration data to the device registers over SPI. The initialization process follows these steps:</p><ul>
<li>Build configuration data arrays for register groups A and B using base data arrays (CFGAR and CFGBR).</li>
<li>Wake up the ADBMS devices using spi_wakeup_adbms1818().</li>
<li>Wait 1 ms to allow hardware stabilization.</li>
<li>Send the MUTE command to ensure that discharge is disabled during configuration.</li>
<li>Write the configuration data to registers WRCFGA and WRCFGB using spi_write_registergroup().</li>
<li>Read back the configuration from registers RDCFGA and RDCFGB using Read_Registergroup().</li>
<li>Compare the written configuration with the read-back data. If any discrepancies are found, the function returns an error code (-ENODEV); otherwise, it returns 0 indicating success.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>0 on success, or a negative error code if hardware initialization fails. </dd></dl>

</div>
</div>
<a id="a7e0a7793a9e5ac7288743e6e5ce4b0a6" name="a7e0a7793a9e5ac7288743e6e5ce4b0a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e0a7793a9e5ac7288743e6e5ce4b0a6">&#9670;&#160;</a></span>spi_generate_pec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t spi_generate_pec </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>data</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a 15-bit Packet Error Code (PEC) for a data buffer. </p>
<p>This function calculates a 15-bit PEC using the polynomial: x^15 + x^14 + x^10 + x^8 + x^7 + x^4 + x^3 + 1.</p>
<p>The PEC is initialized to 0x0010 and then updated bit-by-bit for each bit in the data array. For each byte, the function iterates from the most-significant bit (bit 7) to the least-significant bit (bit 0), computing intermediate values and updating specific bits of the PEC according to the polynomial. Finally, the result is shifted one last time to finalize the PEC value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Pointer to the input data bytes over which the PEC is computed. </td></tr>
    <tr><td class="paramname">length</td><td>Number of bytes in the input data array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed 15-bit PEC, stored in a 16-bit unsigned integer. </dd></dl>

</div>
</div>
<a id="a5dafc139a3e9ecaf7be453e03ea75465" name="a5dafc139a3e9ecaf7be453e03ea75465"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dafc139a3e9ecaf7be453e03ea75465">&#9670;&#160;</a></span>spi_loopback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int spi_loopback </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send a wake-up sequence to the ADBMS1818 using the Daisy Chain method. </p>
<p>This function initiates the wake-up process for the ADBMS1818 devices in a daisy chain. It sends a wake-up message (two bytes of 0xFF) over the SPI bus. The function checks if the SPI device is ready before performing the transmission.</p>
<p>When the SPI_WAKEUP_LOOPBACK_TEST flag is enabled, the function performs a loopback test: it receives the sent wake-up message, compares the received data with the transmitted data, and prints a success or failure message based on the comparison. This test helps verify proper wiring (i.e., MOSI to MISO connection).</p>
<p>In the normal operation mode (when SPI_WAKEUP_LOOPBACK_TEST is disabled), the wake-up message is simply transmitted without expecting a response.</p>
<p>A short delay (10 microseconds) is inserted after the message transmission to allow the devices to settle after waking up.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success, or a negative errno error code on failure. </dd></dl>

</div>
</div>
<a id="a756ec752a2f31def349d63920a309b52" name="a756ec752a2f31def349d63920a309b52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a756ec752a2f31def349d63920a309b52">&#9670;&#160;</a></span>spi_read_adbms_temp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t spi_read_adbms_temp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads and returns the maximum temperature from ADBMS status registers. </p>
<p>This function performs the following steps:</p><ol type="1">
<li>Wakes up the device chain by calling wake_up().</li>
<li>Sends the ADC status command (ADSTAT) using spi_send_command() to initiate temperature conversion.</li>
<li>Waits for 3 milliseconds using k_msleep() to allow the ADC conversion to complete.</li>
<li>Reads the status register group using spi_read_registergroup() with the command RDSTATA.</li>
<li>For each client, extracts the 16-bit raw temperature value from the received data (located at byte indices 2 and 3 of a 6-byte data block per client).</li>
<li>Determines the highest (maximum) raw temperature among all clients.</li>
<li>Converts the maximum raw temperature to a calibrated value using the formula: <pre class="fragment">calibrated_temperature = (raw_temperature * 0.0001 / 0.0076) - 276
</pre> If an SPI error occurs during the register read, the function returns a constant error value of 100.</li>
</ol>
<dl class="section return"><dt>Returns</dt><dd>The calibrated maximum temperature among all clients, or 100 if an SPI read error occurs. </dd></dl>

</div>
</div>
<a id="ae4d0d93aad30a1cc1056de698bfb6eae" name="ae4d0d93aad30a1cc1056de698bfb6eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d0d93aad30a1cc1056de698bfb6eae">&#9670;&#160;</a></span>spi_read_temp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int spi_read_temp </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>data_buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads auxiliary temperature registers via SPI. </p>
<p>This function reads temperature (and auxiliary) data from the device by performing a series of SPI transactions. It uses the following workflow:</p><ul>
<li>Wake up the device chain using spi_wake_up().</li>
<li>Send the ADC auxiliary conversion command (ADAX) using spi_send_command().</li>
<li>Wait 3 ms for the conversion to complete using k_msleep().</li>
<li>For each of the 4 auxiliary register groups (AUXA to AUXD):<ul>
<li>For AUXA to AUXC (i.e. when i &lt; 3), read 6 bytes per client.</li>
<li>For AUXD (i.e. when i == 3), read 2 bytes per client.</li>
</ul>
</li>
<li>The data from each register group is stored in a temporary buffer (sbuffer) and then copied into the output buffer in a format that allocates 20 bytes per client.</li>
<li>Finally, the function rearranges the output buffer to remove unwanted data items (such as reference voltage and certain GPIO values).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The data_buffer parameter is of type uint16_t* but is accessed as a raw byte array by casting it to uint8_t*. Ensure that the provided buffer is large enough to hold the expected data (NUM_OF_CLIENTS * 20 bytes).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data_buffer</td><td>Pointer to the output data buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, or a negative error code on failure. </dd></dl>

</div>
</div>
<a id="a102d72deeb3ff6c0c9f4a9909e737b49" name="a102d72deeb3ff6c0c9f4a9909e737b49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a102d72deeb3ff6c0c9f4a9909e737b49">&#9670;&#160;</a></span>spi_read_voltages()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int spi_read_voltages </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>data_buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads voltage measurements from multiple clients. </p>
<p>This function performs the following sequence:</p><ol type="1">
<li>Wakes up the devices using spi_wake_up().</li>
<li>Sends the ADC voltage conversion command using spi_send_command(ADCV), which internally builds and sends the command using spi_create_command.</li>
<li>Waits 3 milliseconds for the ADC conversion to complete (using Zephyr's k_msleep).</li>
<li>Reads voltage data from 6 different register groups (one per voltage channel) via Read_Registergroup. Each register group read returns a 6-byte block per client.</li>
<li>If the read is successful for a channel, the 6-byte block for each client is placed into the output buffer in a byte-wise manner. Each client has 36 bytes allocated in the output (6 channels * 6 bytes each).</li>
<li>On any read error, the entire output buffer is cleared and the function returns the error status.</li>
</ol>
<p>The input parameter, data_buffer, is declared as a pointer to uint16_t; however, the underlying byte-wise storage is used. This is why a cast to a uint8_t pointer is performed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data_buffer</td><td>Pointer to a 16-bit data buffer that will receive the voltage measurements. The buffer must be large enough to hold NUM_OF_CLIENTS * 36 bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, or a negative errno error code on failure. </dd></dl>

</div>
</div>
<a id="af2451e5eba282f92947029ee03594821" name="af2451e5eba282f92947029ee03594821"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2451e5eba282f92947029ee03594821">&#9670;&#160;</a></span>spi_set_discharge_cell_x()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int spi_set_discharge_cell_x </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>cells_to_balance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configures cell discharge (balancing) settings via SPI. </p>
<p>This function configures the discharge settings (cell balancing) for each battery cell by writing configuration data to the device registers over SPI. Two configuration arrays are prepared (config_data_A and config_data_B) based on base arrays (CFGAR and CFGBR). Specific bits in these arrays are modified using data from the cells_to_balance array. The modified configuration data is then sent to the device using spi_write_registergroup(). After a short delay, a final command is sent via spi_send_command() to either enable (UNMUTE) or disable (MUTE) cell discharge based on whether any cell requires balancing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cells_to_balance</td><td>Pointer to an array of uint32_t values, where each element specifies the balancing configuration for the corresponding cell. The array length is assumed to be at least NUM_OF_CLIENTS.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, or a negative error code if any SPI operation fails. </dd></dl>

</div>
</div>
<a id="aaa4c99a329e2b7ec6d07e1952ca6c633" name="aaa4c99a329e2b7ec6d07e1952ca6c633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa4c99a329e2b7ec6d07e1952ca6c633">&#9670;&#160;</a></span>spi_wake_up()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_wake_up </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wakes up the ADBMS1818 daisy chain. </p>
<p>NEUE FUNKTIONEN </p>
<p>This function sends a series of chip-select (CS) pulses to wake up a daisy chain of ADBMS1818 devices. The sequence consists of (NUM_OF_CLIENTS + 2) pulses. For each pulse:</p><ul>
<li>The CS pin is set low.</li>
<li>A 1 µs delay is applied using k_busy_wait().</li>
<li>The CS pin is set high.</li>
<li>A 400 µs delay is applied using k_busy_wait() to allow the device to register the pulse. Finally, a short delay of about 10 µs is applied to ensure the device is ready for subsequent SPI communication.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Adjust the delays if your ADBMS1818 datasheet requires different timings. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
